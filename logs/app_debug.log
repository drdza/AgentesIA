2025-05-27 22:43:46,854 - ERROR - Error en procesamiento principal
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/usr/local/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/usr/local/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/usr/local/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/usr/local/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/local/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/usr/local/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/usr/local/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7033de523460>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/requests/adapters.py", line 667, in send
    resp = conn.urlopen(
  File "/usr/local/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/usr/local/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /generate_sql (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7033de523460>: Failed to establish a new connection: [Errno 111] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/frontend/views/agente_sql.py", line 55, in <module>
    sql_response = requests.post(API_SQL,json={"question": pregunta_usuario, "domain": dominio})
  File "/usr/local/lib/python3.10/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/usr/local/lib/python3.10/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/requests/adapters.py", line 700, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /generate_sql (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7033de523460>: Failed to establish a new connection: [Errno 111] Connection refused'))
2025-05-28 00:00:13,079 - ERROR - Error en procesamiento principal
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/usr/local/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/usr/local/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/usr/local/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/usr/local/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/local/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/usr/local/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/usr/local/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7c29bcb53e80>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/requests/adapters.py", line 667, in send
    resp = conn.urlopen(
  File "/usr/local/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/usr/local/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /generate_sql (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7c29bcb53e80>: Failed to establish a new connection: [Errno 111] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/frontend/views/agente_sql.py", line 55, in <module>
    sql_response = requests.post(API_SQL,json={"question": pregunta_usuario, "domain": dominio})
  File "/usr/local/lib/python3.10/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/usr/local/lib/python3.10/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/requests/adapters.py", line 700, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /generate_sql (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7c29bcb53e80>: Failed to establish a new connection: [Errno 111] Connection refused'))
2025-05-28 00:00:23,031 - ERROR - Error en procesamiento principal
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/usr/local/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/usr/local/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/usr/local/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/usr/local/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/local/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/usr/local/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/usr/local/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7c29bcb53f40>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/requests/adapters.py", line 667, in send
    resp = conn.urlopen(
  File "/usr/local/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/usr/local/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /generate_sql (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7c29bcb53f40>: Failed to establish a new connection: [Errno 111] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/frontend/views/agente_sql.py", line 55, in <module>
    sql_response = requests.post(API_SQL,json={"question": pregunta_usuario, "domain": dominio})
  File "/usr/local/lib/python3.10/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/usr/local/lib/python3.10/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/requests/adapters.py", line 700, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /generate_sql (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7c29bcb53f40>: Failed to establish a new connection: [Errno 111] Connection refused'))
2025-05-28 00:03:31,117 - ERROR - Error en procesamiento principal
Traceback (most recent call last):
  File "/app/frontend/views/agente_sql.py", line 56, in <module>
    sql_response.raise_for_status()
  File "/usr/local/lib/python3.10/site-packages/requests/models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://agente_sql_backend:8000/generate_sql
2025-05-28 00:04:16,995 - ERROR - Error en procesamiento principal
Traceback (most recent call last):
  File "/app/frontend/views/agente_sql.py", line 56, in <module>
    sql_response.raise_for_status()
  File "/usr/local/lib/python3.10/site-packages/requests/models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://agente_sql_backend:8000/generate_sql
2025-05-28 15:30:14,377 - ERROR - Error en procesamiento principal
Traceback (most recent call last):
  File "/app/frontend/views/agente_sql.py", line 56, in <module>
    sql_response.raise_for_status()
  File "/usr/local/lib/python3.10/site-packages/requests/models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://agente_sql_backend:8000/generate_sql
2025-05-28 15:33:52,809 - ERROR - Error en procesamiento principal
Traceback (most recent call last):
  File "/app/frontend/views/agente_sql.py", line 56, in <module>
    sql_response.raise_for_status()
  File "/usr/local/lib/python3.10/site-packages/requests/models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://agente_sql_backend:8000/generate_sql
2025-05-28 15:34:55,935 - ERROR - Error en procesamiento principal
Traceback (most recent call last):
  File "/app/frontend/views/agente_sql.py", line 56, in <module>
    sql_response.raise_for_status()
  File "/usr/local/lib/python3.10/site-packages/requests/models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://agente_sql_backend:8000/generate_sql
2025-05-28 15:34:58,735 - ERROR - Error en procesamiento principal
Traceback (most recent call last):
  File "/app/frontend/views/agente_sql.py", line 56, in <module>
    sql_response.raise_for_status()
  File "/usr/local/lib/python3.10/site-packages/requests/models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://agente_sql_backend:8000/generate_sql
2025-05-28 15:38:22,457 - ERROR - Error en procesamiento principal
Traceback (most recent call last):
  File "/app/frontend/views/agente_sql.py", line 56, in <module>
    sql_response.raise_for_status()
  File "/usr/local/lib/python3.10/site-packages/requests/models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://agente_sql_backend:8000/generate_sql
2025-05-28 15:49:56,578 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'could not translate host name "pybddwh" to address: Temporary failure in name resolution\n'}
NoneType: None
2025-05-29 22:00:22,480 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'no existe la función current_year()\nLINE 7:   EXTRACT(YEAR FROM fecha_registro) = CURRENT_YEAR()\n                                              ^\nHINT:  Ninguna función coincide en el nombre y tipos de argumentos. Puede ser necesario agregar conversión explícita de tipos.\n'}
NoneType: None
2025-05-29 22:05:54,610 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'la columna «ft_tickets_ia.fecha_registro» debe aparecer en la cláusula GROUP BY o ser usada en una función de agregación\nLINE 2:   EXTRACT(YEAR FROM fecha_registro) AS anio,\n                            ^\n'}
NoneType: None
2025-05-29 22:07:23,340 - ERROR - Error en procesamiento principal
Traceback (most recent call last):
  File "/app/frontend/views/agente_sql.py", line 56, in <module>
    sql_response.raise_for_status()
  File "/usr/local/lib/python3.10/site-packages/requests/models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://agente_sql_backend:8000/generate_sql
2025-05-29 22:08:53,986 - ERROR - Error en procesamiento principal
Traceback (most recent call last):
  File "/app/frontend/views/agente_sql.py", line 56, in <module>
    sql_response.raise_for_status()
  File "/usr/local/lib/python3.10/site-packages/requests/models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://agente_sql_backend:8000/generate_sql
2025-05-29 22:13:52,875 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'no se pueden anidar llamadas a funciones de agregación\nLINE 3:     AVG(COUNT(*)) FILTER(WHERE\n                ^\n'}
NoneType: None
2025-05-29 22:15:48,940 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'la columna «ft_tickets_ia.anio_registro» debe aparecer en la cláusula GROUP BY o ser usada en una función de agregación\nLINE 5:     *\n            ^\n'}
NoneType: None
2025-05-29 22:48:05,156 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'no se pueden anidar llamadas a funciones de agregación\nLINE 3:     AVG(COUNT(*)) FILTER(WHERE\n                ^\n'}
NoneType: None
2025-05-29 23:06:39,034 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'no se pueden anidar llamadas a funciones de agregación\nLINE 2:   AVG(COUNT(*)) AS promedio_tickets_por_dia\n              ^\n'}
NoneType: None
2025-05-29 23:07:43,739 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'no se pueden anidar llamadas a funciones de agregación\nLINE 2:   AVG(COUNT(*)) AS promedio_tickets_por_dia\n              ^\n'}
NoneType: None
2025-05-29 23:08:15,961 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'no se pueden anidar llamadas a funciones de agregación\nLINE 2:   AVG(COUNT(*)) AS promedio_tickets_por_dia\n              ^\n'}
NoneType: None
2025-05-29 23:12:13,722 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'no se pueden anidar llamadas a funciones de agregación\nLINE 2:   AVG(COUNT(*)) AS promedio_tickets_por_dia\n              ^\n'}
NoneType: None
2025-05-29 23:42:12,343 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'no existe la columna «ranking»\nLINE 15:   ranking = 1\n           ^\n'}
NoneType: None
2025-05-30 19:30:31,175 - ERROR - Error en procesamiento principal
Traceback (most recent call last):
  File "/app/frontend/views/agente_sql.py", line 56, in <module>
    sql_response.raise_for_status()
  File "/usr/local/lib/python3.10/site-packages/requests/models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://agente_sql_backend:8000/generate_sql
2025-05-30 19:35:47,395 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'no se pueden anidar llamadas a funciones de agregación\nLINE 2:   AVG(COUNT(*))\n              ^\n'}
NoneType: None
2025-06-02 15:16:30,057 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «DAYS»\nLINE 6:     CURRENT_DATE - INTERVAL '30' DAYS\n                                         ^\n"}
NoneType: None
2025-06-02 15:37:22,600 - ERROR - ❌ Error al ejecutar el SQL
{'error': "no existe la columna «generated_date»\nLINE 5:   generated_date >= DATE_TRUNC('YEAR', CURRENT_DATE) - INTER...\n          ^\n"}
NoneType: None
2025-06-02 15:38:07,361 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'no existe la columna «estado»\nLINE 2:   estado\n          ^\n'}
NoneType: None
2025-06-02 15:40:55,977 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'no existe la columna «city»\nLINE 2:   city,\n          ^\n'}
NoneType: None
2025-06-03 10:16:52,720 - INFO - Payload: {'type': 'sql', 'question': '¿Cuántos tickets se han resuelto fuera del SLA este mes?', 'content': "SELECT COUNT(*) FROM ft_tickets_ia WHERE tiempo_solucion_total > tiempo_sla_servicio AND fecha_resolucion >= date_trunc('month', CURRENT_DATE);"}
2025-06-03 10:18:58,245 - INFO - Payload: {'type': 'sql', 'question': '¿Cuántos tickets se han resuelto fuera del SLA este mes?', 'content': "SELECT COUNT(*) FROM ft_tickets_ia WHERE tiempo_solucion_total > tiempo_sla_servicio AND fecha_resolucion >= date_trunc('month', CURRENT_DATE);"}
2025-06-03 10:23:02,954 - INFO - Payload: {'type': 'sql', 'question': '¿Cuántos tickets se han resuelto fuera del SLA este mes?', 'content': "SELECT COUNT(*) FROM ft_tickets_ia WHERE tiempo_solucion_total > tiempo_sla_servicio AND fecha_resolucion >= date_trunc('month', CURRENT_DATE);"}
2025-06-03 10:27:32,940 - INFO - Payload: {'type': 'ddl', 'question': '¿Qué estructura tiene la tabla de tickets?', 'content': '-- Estructura simplificada de la vista materializada ft_tickets_ia\n-- Esta vista consolida datos de tickets, personal, centros y servicios\nCREATE MATERIALIZED VIEW ft_tickets_ia (\n    fecha_registro DATE,\n    anio_registro INTEGER,\n    mes_registro INTEGER,\n    fecha_cierre DATE,\n    estatus_ticket TEXT,\n    folio_ticket TEXT,\n    sistema TEXT,\n    motivo_ticket TEXT,\n    motivo_cierre_ticket TEXT,\n    servicio_cierre_ticket TEXT,\n    centro_trabajo TEXT,\n    ciudad TEXT,\n    empresa TEXT,\n    unidad_negocio TEXT,\n    personal_reporta TEXT,\n    colaborador_asignado TEXT,\n    departamento_colaborador_asignado TEXT,\n    area_colaborador_asignado TEXT,\n    servicio TEXT,\n    tiempo_solucion_total INTERVAL,\n    tiempo_sla_servicio INTERVAL\n);'}
2025-06-03 10:28:05,690 - INFO - Payload: {'type': 'docs', 'question': '¿Qué significa que un ticket esté fuera del SLA?', 'content': 'Un ticket se considera fuera del SLA cuando el tiempo total de solución supera el tiempo asignado por el SLA del servicio. Esta métrica se calcula como: tiempo_solucion_total > tiempo_sla_servicio.'}
2025-06-03 10:40:26,458 - ERROR - Error en procesamiento principal
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 56, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-03 10:40:42,923 - ERROR - Error en procesamiento principal
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 56, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-03 10:44:11,741 - ERROR - Error en procesamiento principal
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 56, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-03 10:44:35,362 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'no existe la columna «created_at»\nLINE 5:   EXTRACT(MONTH FROM created_at) = 12 AND EXTRACT(YEAR FROM ...\n                             ^\n'}
NoneType: None
2025-06-03 11:02:03,807 - INFO - Payload: {'type': 'sql', 'question': '¿Cuántos tickets se han generado en el último mes del año 2025?', 'content': 'SELECT COUNT(*) FROM ft_tickets_ia WHERE EXTRACT(MONTH FROM fecha_registro) = 12 AND EXTRACT(YEAR FROM fecha_registro) = 2025;'}
2025-06-03 11:02:27,556 - INFO - Payload: {'type': 'sql', 'question': '¿Cuántos tickets se generaron en el último mes registrado?', 'content': "SELECT COUNT(*) FROM ft_tickets_ia WHERE fecha_registro >= date_trunc('month', CURRENT_DATE - interval '1 month') AND fecha_registro < date_trunc('month', CURRENT_DATE);"}
2025-06-03 11:06:44,633 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'no existe la columna «created_at»\nLINE 5:   EXTRACT(MONTH FROM created_at) = 12 AND EXTRACT(YEAR FROM ...\n                             ^\n'}
NoneType: None
2025-06-03 11:15:44,902 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'no existe la columna «created_at»\nLINE 5:   EXTRACT(MONTH FROM created_at) = 12 AND EXTRACT(YEAR FROM ...\n                             ^\n'}
NoneType: None
2025-06-03 11:25:15,549 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'no existe la columna «created_at»\nLINE 5:   EXTRACT(MONTH FROM created_at) = 12 AND EXTRACT(YEAR FROM ...\n                             ^\n'}
NoneType: None
2025-06-03 11:39:04,838 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'no existe la columna «created_at»\nLINE 5:   EXTRACT(MONTH FROM created_at) = 12 AND EXTRACT(YEAR FROM ...\n                             ^\n'}
NoneType: None
2025-06-03 12:41:56,171 - INFO - Payload: {'type': 'ddl', 'question': 'DDL de la tabla tickets(ft_tickets_ia)', 'content': '-- DDL de tabla tickets ( ft_tickets_ia )\nCREATE MATERIALIZED VIEW ft_tickets_ia (\n    fecha_registro DATE,\n    anio_registro INTEGER,\n    mes_registro INTEGER,\n    fecha_cierre DATE,\n    estatus_ticket TEXT,\n    folio_ticket TEXT,\n    sistema TEXT,\n    motivo_ticket TEXT,\n    motivo_cierre_ticket TEXT,\n    servicio_cierre_ticket TEXT,\n    centro_trabajo TEXT,\n    ciudad TEXT,\n    empresa TEXT,\n    unidad_negocio TEXT,\n    personal_reporta TEXT,\n    colaborador_asignado TEXT,\n    departamento_colaborador_asignado TEXT,\n    area_colaborador_asignado TEXT,\n    servicio TEXT,\n    tiempo_solucion_total INTERVAL,\n    tiempo_sla_servicio INTERVAL\n);\n'}
2025-06-03 12:42:50,826 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'no existe la columna «created_at»\nLINE 5:   EXTRACT(YEAR FROM created_at) = 2025\n                            ^\n'}
NoneType: None
2025-06-03 15:40:33,116 - ERROR - Error en procesamiento principal
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 56, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-03 15:43:09,884 - ERROR - Error en procesamiento principal
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 56, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-03 15:47:02,111 - ERROR - Error en procesamiento principal
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 56, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-03 15:55:26,234 - ERROR - Error en procesamiento principal
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 56, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-03 16:05:03,350 - ERROR - Error en procesamiento principal
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 56, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-03 16:18:44,349 - ERROR - Error en procesamiento principal
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 56, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-03 16:21:42,834 - ERROR - Error en procesamiento principal
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 56, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-03 17:22:42,597 - ERROR - Error en procesamiento principal
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 73, in <module>
    st.text_area(data['sql'], language="sql")
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\streamlit\runtime\metrics_util.py", line 410, in wrapped_func
    result = non_optional_func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: TextWidgetsMixin.text_area() got an unexpected keyword argument 'language'
2025-06-03 17:33:53,186 - ERROR - ❌ Error al consultar agente SQL: 404 Client Error: Not Found for url: http://localhost:8000/generate_sql/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\chat.py", line 37, in <module>
    response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 404 Client Error: Not Found for url: http://localhost:8000/generate_sql/generate_sql
2025-06-03 17:35:14,029 - ERROR - ❌ Error al consultar agente SQL: 404 Client Error: Not Found for url: http://localhost:8000/generate_sql/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\chat.py", line 37, in <module>
    response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 404 Client Error: Not Found for url: http://localhost:8000/generate_sql/generate_sql
2025-06-04 11:52:53,927 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-04 11:54:57,720 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-04 11:57:21,725 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-04 12:13:17,603 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-04 12:19:12,567 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 12:20:09,824 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 12:20:43,508 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 12:20:47,141 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 12:20:52,897 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 12:22:02,544 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 12:25:21,785 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 12:25:49,418 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 12:26:27,607 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 12:26:40,288 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 12:27:22,760 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 12:32:52,891 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 12:34:01,431 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 13:03:03,761 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 13:03:24,959 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 13:03:34,837 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-04 13:03:34,889 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 13:04:29,094 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 13:39:18,771 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 13:45:44,431 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 13:45:58,610 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 13:46:05,546 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-04 13:46:05,600 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 13:46:36,583 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 15:16:55,552 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 15:22:27,095 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 15:25:49,089 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 15:26:39,560 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 15:28:11,343 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 15:29:30,096 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 15:30:07,830 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 15:34:32,294 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 15:35:54,837 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 15:36:50,549 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 15:56:34,523 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 15:57:39,304 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 16:00:07,604 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 16:01:12,620 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 16:05:42,722 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 16:07:10,508 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 16:09:01,326 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 16:12:14,760 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 59, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-04 16:13:43,936 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 59, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-04 16:22:13,920 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 59, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-04 16:26:40,214 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 16:28:07,709 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 16:28:17,467 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-04 16:28:17,520 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «MONTHS»\nLINE 7: ...>= DATE_TRUNC('QUARTER', CURRENT_DATE) - INTERVAL '3' MONTHS\n                                                                 ^\n"}
NoneType: None
2025-06-04 16:29:04,639 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 59, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-04 16:39:29,244 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 59, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-04 17:55:22,428 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-04 17:58:22,241 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-04 17:59:11,553 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-04 18:04:06,314 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-05 09:13:25,312 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'no existe la columna «cantidad_atenciones»\nLINE 7:     ROW_NUMBER() OVER (ORDER BY cantidad_atenciones DESC) AS...\n                                        ^\n'}
NoneType: None
2025-06-05 09:14:52,657 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'no existe la columna «cantidad_atenciones»\nLINE 7:     ROW_NUMBER() OVER (ORDER BY cantidad_atenciones DESC) AS...\n                                        ^\n'}
NoneType: None
2025-06-05 09:19:07,849 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'la columna «subquery.servicio» debe aparecer en la cláusula GROUP BY o ser usada en una función de agregación\nLINE 5:     servicio,\n            ^\n'}
NoneType: None
2025-06-05 09:20:38,592 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'la columna «subquery.servicio» debe aparecer en la cláusula GROUP BY o ser usada en una función de agregación\nLINE 5:     servicio,\n            ^\n'}
NoneType: None
2025-06-05 09:21:15,598 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'la columna «subquery.servicio» debe aparecer en la cláusula GROUP BY o ser usada en una función de agregación\nLINE 5:     servicio,\n            ^\n'}
NoneType: None
2025-06-05 09:22:25,562 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-05 09:24:36,426 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 59, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-05 09:27:33,276 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «HOURS»\nLINE 9: ...erre IS NULL AND tiempo_solucion_total < INTERVAL '24' HOURS\n                                                                  ^\n"}
NoneType: None
2025-06-05 09:28:03,182 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «HOURS»\nLINE 9: ...erre IS NULL AND tiempo_solucion_total < INTERVAL '24' HOURS\n                                                                  ^\n"}
NoneType: None
2025-06-05 09:29:32,634 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «HOURS»\nLINE 9: ...erre IS NULL AND tiempo_solucion_total < INTERVAL '24' HOURS\n                                                                  ^\n"}
NoneType: None
2025-06-05 09:33:57,575 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «HOURS»\nLINE 9: ...erre IS NULL AND tiempo_solucion_total < INTERVAL '24' HOURS\n                                                                  ^\n"}
NoneType: None
2025-06-05 09:59:52,754 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-05 10:00:31,856 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «DAYS»\nLINE 10:     ) < INTERVAL '3' DAYS\n                              ^\n"}
NoneType: None
2025-06-05 10:01:26,543 - ERROR - ❌ Error al ejecutar el SQL
{'error': "no existe la función datediff(unknown, date, date)\nLINE 3:     CAST(SUM(CASE WHEN DATEDIFF('day', fecha_registro, FECHA...\n                               ^\nHINT:  Ninguna función coincide en el nombre y tipos de argumentos. Puede ser necesario agregar conversión explícita de tipos.\n"}
NoneType: None
2025-06-05 10:02:18,993 - ERROR - ❌ Error al ejecutar el SQL
{'error': "no existe la función datediff(unknown, date, date)\nLINE 3:     CAST(SUM(CASE WHEN DATEDIFF('day', fecha_registro, FECHA...\n                               ^\nHINT:  Ninguna función coincide en el nombre y tipos de argumentos. Puede ser necesario agregar conversión explícita de tipos.\n"}
NoneType: None
2025-06-05 10:02:26,022 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-05 10:02:26,074 - ERROR - ❌ Error al ejecutar el SQL
{'error': "no existe la función datediff(unknown, date, date)\nLINE 3:     CAST(SUM(CASE WHEN DATEDIFF('day', fecha_registro, FECHA...\n                               ^\nHINT:  Ninguna función coincide en el nombre y tipos de argumentos. Puede ser necesario agregar conversión explícita de tipos.\n"}
NoneType: None
2025-06-05 10:02:52,097 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «DAYS»\nLINE 10:     ) < INTERVAL '3' DAYS\n                              ^\n"}
NoneType: None
2025-06-05 10:08:25,378 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «DAYS»\nLINE 10:     ) < INTERVAL '3' DAYS\n                              ^\n"}
NoneType: None
2025-06-05 10:09:34,943 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-05 10:24:05,921 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-05 10:25:30,169 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-05 10:27:06,802 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-05 10:28:34,385 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-05 10:33:24,616 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-05 11:10:36,090 - WARNING - ⚠️  La colección 'sql_agent_questions' ya existe. Omitiendo...
2025-06-05 11:10:36,221 - WARNING - ⚠️  La colección 'sql_ddl' ya existe. Omitiendo...
2025-06-05 11:10:36,308 - WARNING - ⚠️  La colección 'sql_docs' ya existe. Omitiendo...
2025-06-05 11:11:16,228 - WARNING - ⚠️  La colección 'sql_agent_questions' ya existe. Omitiendo...
2025-06-05 11:11:16,291 - WARNING - ⚠️  La colección 'sql_ddl' ya existe. Omitiendo...
2025-06-05 11:11:16,476 - WARNING - ⚠️  La colección 'sql_docs' ya existe. Omitiendo...
2025-06-05 11:11:48,600 - WARNING - ⚠️  La colección 'sql_agent_questions' ya existe. Omitiendo...
2025-06-05 11:11:48,608 - WARNING - ⚠️  La colección 'sql_ddl' ya existe. Omitiendo...
2025-06-05 11:11:48,661 - WARNING - ⚠️  La colección 'sql_docs' ya existe. Omitiendo...
2025-06-05 11:21:33,874 - WARNING - ⚠️  La colección 'sql_agent_questions' ya existe. Omitiendo...
2025-06-05 11:21:33,954 - WARNING - ⚠️  La colección 'sql_ddl' ya existe. Omitiendo...
2025-06-05 11:21:34,013 - WARNING - ⚠️  La colección 'sql_docs' ya existe. Omitiendo...
2025-06-05 11:24:10,842 - WARNING - ⚠️  La colección 'sql_agent_questions' ya existe. Omitiendo...
2025-06-05 11:24:10,949 - WARNING - ⚠️  La colección 'sql_ddl' ya existe. Omitiendo...
2025-06-05 11:24:11,540 - WARNING - ⚠️  La colección 'sql_docs' ya existe. Omitiendo...
2025-06-05 11:36:30,026 - INFO - Payload: {'type': 'docs', 'question': 'Tiempo total de solución vs SLA', 'content': 'Un ticket se considera fuera del SLA cuando tiempo_solucion_total > tiempo_sla_servicio. Ambos campos están en segundos.'}
2025-06-05 11:37:17,627 - INFO - Payload: {'type': 'docs', 'question': 'Estatus de tickets', 'content': "El campo estatus_ticket puede tomar valores como 'ATENDIDO', 'EN PROCESO', etc. Filtra por 'ATENDIDO' para tickets cerrados."}
2025-06-05 11:39:25,508 - INFO - Payload: {'type': 'docs', 'question': 'Búsquedas o filtros relacionados a fines de semana', 'content': 'Utiliza EXTRACT(DOW FROM <CAMPO_FECHA>) para obtener el día de la semana. Los fines de semana corresponden a: 0: Domingo, 6: Sábado'}
2025-06-05 11:41:49,412 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-05 11:45:45,644 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-05 11:48:48,976 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-05 12:39:38,030 - INFO - Payload: {'type': 'sql', 'question': '¿Podrías decirme cuántos tickets abiertos hay en cada departamento y para cada uno de ellos obtener la fecha más antigua?', 'content': "select\n departamento_colaborador_asignado as departamento,\nCOUNT(*) as tickets_abiertos,\nMIN(fecha_registro) as fecha_antigua\nfrom ft_tickets_ia\nwhere fecha_cierre is null and estatus_ticket <> 'CANCELADO'\ngroup by departamento_colaborador_asignado;"}
2025-06-05 12:50:44,229 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'no se permiten funciones de ventana deslizante en WHERE\nLINE 27:   ROW_NUMBER() OVER (ORDER BY promedio_tiempo_atencion ASC) ...\n           ^\n'}
NoneType: None
2025-06-05 12:51:22,787 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'no se permiten funciones de ventana deslizante en WHERE\nLINE 27:   ROW_NUMBER() OVER (ORDER BY promedio_tiempo_atencion ASC) ...\n           ^\n'}
NoneType: None
2025-06-05 12:52:52,594 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'no se permiten funciones de ventana deslizante en WHERE\nLINE 27:   ROW_NUMBER() OVER (ORDER BY promedio_tiempo_atencion ASC) ...\n           ^\n'}
NoneType: None
2025-06-05 15:07:04,364 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-05 15:08:46,996 - INFO - Payload: {'type': 'docs', 'question': 'Tickets fuera de tiempo', 'content': 'Se consideran tickets fuera de tiempo aquellos donde el tiempo de SLA es menor al tiempo de solución total sin importar el estatus del ticket. ```where tiempo_solucion_total > tiempo_sla_servicio```'}
2025-06-05 15:09:37,271 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «DAYS»\nLINE 15:     tiempo_atencion > INTERVAL '3' DAYS\n                                            ^\n"}
NoneType: None
2025-06-05 15:15:35,174 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «DAYS»\nLINE 15:     tiempo_atencion > INTERVAL '3' DAYS\n                                            ^\n"}
NoneType: None
2025-06-05 15:16:42,639 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «DAYS»\nLINE 15:     tiempo_atencion > INTERVAL '3' DAYS\n                                            ^\n"}
NoneType: None
2025-06-05 15:17:04,393 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «DAYS»\nLINE 15:     tiempo_atencion > INTERVAL '3' DAYS\n                                            ^\n"}
NoneType: None
2025-06-05 15:17:56,009 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «DAYS»\nLINE 15:     tiempo_atencion > INTERVAL '3' DAYS\n                                            ^\n"}
NoneType: None
2025-06-05 15:29:25,551 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-05 15:29:25,605 - ERROR - ❌ Error al ejecutar el SQL
{'error': "error de sintaxis en o cerca de «DAYS»\nLINE 15:     tiempo_atencion > INTERVAL '3' DAYS\n                                            ^\n"}
NoneType: None
2025-06-05 15:29:55,245 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'no existe la función pg_catalog.extract(unknown, integer)\nLINE 4:     EXTRACT(EPOCH FROM (\n            ^\nHINT:  Ninguna función coincide en el nombre y tipos de argumentos. Puede ser necesario agregar conversión explícita de tipos.\n'}
NoneType: None
2025-06-05 15:30:43,331 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'no existe la función pg_catalog.extract(unknown, integer)\nLINE 4:     EXTRACT(EPOCH FROM (\n            ^\nHINT:  Ninguna función coincide en el nombre y tipos de argumentos. Puede ser necesario agregar conversión explícita de tipos.\n'}
NoneType: None
2025-06-05 15:31:29,530 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'no existe la función pg_catalog.extract(unknown, integer)\nLINE 4:     EXTRACT(EPOCH FROM (\n            ^\nHINT:  Ninguna función coincide en el nombre y tipos de argumentos. Puede ser necesario agregar conversión explícita de tipos.\n'}
NoneType: None
2025-06-05 15:36:37,236 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-05 15:38:40,624 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-05 15:59:29,253 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'la referencia a la columna «departamento» es ambigua\nLINE 21:   departamento,\n           ^\n'}
NoneType: None
2025-06-05 16:00:39,842 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'la referencia a la columna «departamento» es ambigua\nLINE 21:   departamento,\n           ^\n'}
NoneType: None
2025-06-06 13:27:12,349 - INFO - Payload: {'type': 'docs', 'question': 'Tickets fuera de tiempo o estatus de atención del SLA', 'content': "Para identificar que un ticket está fuera de tiempo se hace uso del campo `estatus_atencion` el cual puede tener los valores 'FUERA DE TIEMPO', 'POR VENCER' y 'TIEMPO'.\n\n'FUERA DE TIEMPO': es cuando el SLA actual ya se ha vencido por completo.\n'POR VENCER': refiere a que se ha consumido un 65% del tiempo del SLA.\n'TIEMPO': hace referencia a que el SLA aún está por debajo del 65% del tiempo del SLA."}
2025-06-06 16:03:02,937 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-06 16:12:01,777 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-06 16:44:26,504 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'la referencia a la columna «unidad_negocio» es ambigua\nLINE 23:   unidad_negocio,\n           ^\n'}
NoneType: None
2025-06-06 16:46:45,748 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'falta una entrada para la tabla «tickets_atendidos» en la cláusula FROM\nLINE 20:     tickets_atendidos.tickets_atendidos / tickets_atendidos_...\n             ^\n'}
NoneType: None
2025-06-06 16:48:24,878 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'falta una entrada para la tabla «tickets_atendidos» en la cláusula FROM\nLINE 20:     tickets_atendidos.tickets_atendidos / tickets_atendidos_...\n             ^\n'}
NoneType: None
2025-06-06 16:48:53,155 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-06 16:48:53,208 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'falta una entrada para la tabla «tickets_atendidos» en la cláusula FROM\nLINE 20:     tickets_atendidos.tickets_atendidos / tickets_atendidos_...\n             ^\n'}
NoneType: None
2025-06-06 16:51:51,220 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-06 17:20:55,120 - ERROR - ❌ Fallo al ejecutar el SQL.
'sql'
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 115, in <module>
    data['sql'] = response.json()["sql"]
                  ~~~~~~~~~~~~~~~^^^^^^^
KeyError: 'sql'
2025-06-06 17:22:16,541 - ERROR - ❌ Fallo al ejecutar el SQL.
'sql'
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 114, in <module>
    data['sql'] = response.json()["sql"]
                  ~~~~~~~~~~~~~~~^^^^^^^
KeyError: 'sql'
2025-06-06 17:23:36,636 - ERROR - ❌ Fallo al ejecutar el SQL.
'sql'
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 100, in <module>
    data['sql'] = response.json()["sql"]
                  ~~~~~~~~~~~~~~~^^^^^^^
KeyError: 'sql'
2025-06-06 17:23:49,266 - ERROR - ❌ Fallo al ejecutar el SQL.
'sql'
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 100, in <module>
    data['sql'] = response.json()["sql"]
                  ~~~~~~~~~~~~~~~^^^^^^^
KeyError: 'sql'
2025-06-06 17:27:27,308 - ERROR - ❌ Fallo al ejecutar el SQL.
'sql'
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 102, in <module>
    data['sql'] = response.json()["sql"]
                  ~~~~~~~~~~~~~~~^^^^^^^
KeyError: 'sql'
2025-06-06 17:37:09,339 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'no existe la relación «ft_tickets_ias»\nLINE 3: FROM ft_tickets_ias\n             ^\n'}
NoneType: None
2025-06-06 17:37:30,750 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'no existe la relación «ft_tickets_ias»\nLINE 3: FROM ft_tickets_ias\n             ^\n'}
NoneType: None
2025-06-06 17:38:55,963 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'no existe la relación «ft_tickets_ias»\nLINE 3: FROM ft_tickets_ias\n             ^\n'}
NoneType: None
2025-06-06 17:39:48,430 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'no existe la relación «ft_tickets_ias»\nLINE 3: FROM ft_tickets_ias\n             ^\n'}
NoneType: None
2025-06-06 17:41:01,098 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'no existe la relación «ft_tickets_ias»\nLINE 3: FROM ft_tickets_ias\n             ^\n'}
NoneType: None
2025-06-06 17:41:21,270 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'no existe la relación «ft_tickets_ias»\nLINE 3: FROM ft_tickets_ias\n             ^\n'}
NoneType: None
2025-06-06 17:43:37,379 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'no existe la relación «ft_tickets_ias»\nLINE 3: FROM ft_tickets_ias\n             ^\n'}
NoneType: None
2025-06-06 17:43:39,903 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'no existe la relación «ft_tickets_ias»\nLINE 3: FROM ft_tickets_ias\n             ^\n'}
NoneType: None
2025-06-07 11:32:29,561 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-07 11:38:43,634 - INFO - Payload: {'type': 'docs', 'question': 'Estatus de tickets o estados de tickets', 'content': "El campo `estatus_ticket` puede tomar valores como 'ATENDIDO', 'EN PROCESO', 'CANCELADO', etc.\n - Filtra por 'ATENDIDO' para tickets cerrados o atendidos.\n - Filtra por 'EN PROCESO' para tickets que siguen abiertos o en proceso."}
2025-06-07 11:40:44,704 - INFO - Payload: {'type': 'docs', 'question': 'Tickets fuera de tiempo o estatus de atención del SLA', 'content': "Para identificar que un ticket está fuera de tiempo se hace uso del campo `estatus_atencion` el cual puede tener los valores 'FUERA DE TIEMPO', 'POR VENCER' y 'TIEMPO'. Este campo debe omitirse en la combinación con el campo `estatus_ticket`='ATENDIDO'\n\n - 'FUERA DE TIEMPO': es cuando el SLA actual ya se ha vencido por completo.\n - 'POR VENCER': refiere a que se ha consumido un 65% del tiempo del SLA.\n - 'TIEMPO': hace referencia a que el SLA aún está por debajo del 65% del tiempo del SLA."}
2025-06-07 12:00:19,662 - INFO - Payload: {'type': 'docs', 'question': 'Tickets fuera de tiempo o estatus de atención del SLA', 'content': "Para identificar que un ticket está fuera de tiempo se hace uso del campo `estatus_atencion` el cual puede tener los valores 'FUERA DE TIEMPO', 'POR VENCER' y 'TIEMPO'. \n\n**Este campo se combina estrictamente con el valor del campo`estatus_ticket = 'EN PROCESO'`**\n\n - **'FUERA DE TIEMPO'**: es cuando el SLA actual ya se ha vencido por completo.\n - **'POR VENCER'**: refiere a que se ha consumido un 65% del tiempo del SLA.\n - **'TIEMPO'**: hace referencia a que el SLA aún está por debajo del 65% del tiempo del SLA."}
2025-06-07 12:04:00,675 - INFO - Payload: {'type': 'sql', 'question': 'Tickets abiertos', 'content': "Considera como tickets abiertos aquellos `estatus_ticket <> 'CANCELADO' and fecha_cierre IS NULL` para este caso **omite** un filtrado por el campo `estatus_atencion` ya que este campo solo aplica para tciekts **en proceso** (`estatus_ticket = 'EN PROCESO'`)"}
2025-06-07 12:04:54,601 - INFO - Payload: {'type': 'docs', 'question': 'Tickets abiertos', 'content': "Considera como tickets abiertos aquellos `estatus_ticket <> 'CANCELADO' and fecha_cierre IS NULL` para este caso **omite** un filtrado por el campo `estatus_atencion` ya que este campo solo aplica para tciekts **en proceso** (`estatus_ticket = 'EN PROCESO'`)"}
2025-06-07 13:51:13,631 - INFO - Payload: {'type': 'docs', 'question': '¿Cómo identificar si un ticket en proceso está fuera del SLA usando el campo estatus_atencion?', 'content': "Para identificar que un ticket está fuera de tiempo se hace uso del campo `estatus_atencion` el cual puede tener los valores 'FUERA DE TIEMPO', 'POR VENCER' y 'TIEMPO'.\n\n**Este campo se combina estrictamente con el valor del campo`estatus_ticket = 'EN PROCESO'`**\n\n - **'FUERA DE TIEMPO'**: es cuando el SLA actual ya se ha vencido por completo.\n - **'POR VENCER'**: refiere a que se ha consumido un 65% del tiempo del SLA.\n - **'TIEMPO'**: hace referencia a que el SLA aún está por debajo del 65% del tiempo del SLA."}
2025-06-07 13:53:48,187 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-07 13:58:43,494 - INFO - Payload: {'type': 'docs', 'question': '¿Cómo saber si un ticket está abierto actualmente?', 'content': "Se consideran como tickets abiertos aquellos que cumplen con la condición: `estatus_ticket <> 'CANCELADO' and fecha_cierre IS NULL`, para este caso se **omite** el filtrado por el campo `estatus_atencion` ya que este campo solo aplica para tickets **en proceso** (`estatus_ticket = 'EN PROCESO'`)"}
2025-06-09 10:03:42,785 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'el operador no existe: text / double precision\nLINE 6:     AVG(tiempo_atencion / tiempo_sla_servicio * 100) AS porc...\n                                ^\nHINT:  Ningún operador coincide en el nombre y tipos de argumentos. Puede ser necesario agregar conversión explícita de tipos.\n'}
NoneType: None
2025-06-09 11:20:17,824 - ERROR - ❌ Error al ejecutar el SQL
{'error': 'el operador no existe: text / double precision\nLINE 6:     AVG(tiempo_atencion / tiempo_sla_servicio * 100) AS porc...\n                                ^\nHINT:  Ningún operador coincide en el nombre y tipos de argumentos. Puede ser necesario agregar conversión explícita de tipos.\n'}
NoneType: None
2025-06-12 13:50:16,166 - ERROR - Error al consultar el backend: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /generate_sql (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0000027859269710>: Failed to establish a new connection: [WinError 10061] No se puede establecer una conexión ya que el equipo de destino denegó expresamente dicha conexión'))
Traceback (most recent call last):
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [WinError 10061] No se puede establecer una conexión ya que el equipo de destino denegó expresamente dicha conexión

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\urllib3\connection.py", line 445, in request
    self.endheaders()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\http\client.py", line 1298, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\http\client.py", line 1058, in _send_output
    self.send(msg)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\http\client.py", line 996, in send
    self.connect()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\urllib3\connection.py", line 276, in connect
    self.sock = self._new_conn()
                ^^^^^^^^^^^^^^^^
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x0000027859269710>: Failed to establish a new connection: [WinError 10061] No se puede establecer una conexión ya que el equipo de destino denegó expresamente dicha conexión

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\adapters.py", line 667, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\urllib3\util\retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /generate_sql (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0000027859269710>: Failed to establish a new connection: [WinError 10061] No se puede establecer una conexión ya que el equipo de destino denegó expresamente dicha conexión'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 59, in <module>
    sql_response = requests.post(API_SQL_GENERATION,json={"question": pregunta_usuario, "domain": dominio})
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\adapters.py", line 700, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /generate_sql (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0000027859269710>: Failed to establish a new connection: [WinError 10061] No se puede establecer una conexión ya que el equipo de destino denegó expresamente dicha conexión'))
2025-06-12 18:21:14,584 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-12 18:24:02,402 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-12 18:25:10,598 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-16 13:11:06,419 - INFO - Payload: {'type': 'docs', 'question': '¿Cómo saber que un ticket está fuera de tiempo?', 'content': "Se considera que un ticket está fuera de tiempo a través del campo `estatus_atencion = 'FUERA DE TIEMPO'` y se combina con los tickets con `estatus_ticket = 'EN PROCESO'`"}
2025-06-16 13:18:47,436 - INFO - Payload: {'type': 'docs', 'question': '¿Cuáles son los tickets en proceso?', 'content': "Los tickets en proceso son aquellos que tienen `estatus_ticket = 'EN PROCESO'`y que su `fecha_cierre IS NOT NULL`'"}
2025-06-16 13:21:08,680 - INFO - Payload: {'type': 'docs', 'question': '¿Cuáles son los tickets abiertos?', 'content': "Se consideran como tickets abiertos aquellos que están en cualquier `estatus_ticket NOT IN ('ATENDIDO', 'CANCELADO')` y que su `fecha_cierre IS NOT NULL`."}
2025-06-16 13:22:27,467 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-16 13:24:56,297 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-16 13:25:36,017 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-16 13:29:06,693 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-16 13:31:37,465 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-16 13:35:00,018 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-16 13:35:46,233 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-16 13:36:35,543 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-16 13:37:52,992 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-16 13:39:19,167 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-16 13:45:39,299 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-16 13:45:48,839 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-16 13:48:36,646 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-16 13:50:21,177 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-16 13:50:30,416 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-16 13:52:31,137 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-16 13:55:18,914 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-16 13:58:27,609 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-16 14:00:58,999 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-16 14:02:02,143 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-16 14:02:17,448 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-16 14:02:57,578 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-16 14:57:27,495 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-16 15:04:50,349 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-16 15:27:44,880 - INFO - Payload: {'type': 'docs', 'question': '¿Cuáles son los tickets abiertos?', 'content': "Se consideran como tickets abiertos aquellos que cumplen las siguiente condición: `estatus_ticket NOT IN ('ATENDIDO', 'CANCELADO') and fecha_cierre IS NULL`."}
2025-06-16 15:29:16,561 - INFO - Payload: {'type': 'docs', 'question': '¿Cuáles son los tickets en proceso?', 'content': "Los tickets en proceso son aquellos que cumplen con está regla: `estatus_ticket = 'EN PROCESO' and fecha_cierre IS NULL`."}
2025-06-16 15:30:08,976 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-16 15:30:36,845 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-16 15:31:36,558 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-16 15:32:44,927 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-16 15:37:57,061 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-16 15:40:53,638 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-16 15:42:04,490 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-16 15:42:39,207 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-16 16:19:03,619 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-16 16:28:12,438 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-16 16:31:05,262 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-16 16:39:40,319 - INFO - Payload: {'type': 'sql', 'question': 'Muestra los tickets abiertos, indicando para cada departamento y área  cuantos siguen en proceso.', 'content': 'select\n  departamento_colaborador_asignado as "Departamento",\n  area_colaborador_asignado as "Área",\n  CAST(COUNT(*) filter(where estatus_ticket not in (\'ATENDIDO\', \'CANCELADO\') and fecha_cierre is null) as DECIMAL) as "Tickes Abiertos",  \n  CAST(COUNT(*) filter(where estatus_ticket = \'EN PROCESO\' and fecha_cierre is null) as DECIMAL) as "Tickets En Proceso"\nfrom ft_tickets_ia\ngroup by\n  departamento_colaborador_asignado,\n  area_colaborador_asignado\norder by departamento_colaborador_asignado, area_colaborador_asignado;'}
2025-06-16 16:40:18,774 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-16 16:43:37,130 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-16 16:48:51,528 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-16 16:50:21,688 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-16 16:51:11,687 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-16 16:52:10,526 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-16 16:53:06,437 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-16 17:11:18,632 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-16 17:25:24,388 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-16 17:30:02,103 - INFO - Payload: {'type': 'docs', 'question': '¿Como identificar los tickets registrados?', 'content': "Se considera que un ticket fue registrado si su estatus_ticket es distinto de 'CANCELADO'. Por lo tanto, deben cumplirse todas las siguientes condiciones:\n- El ticket existe en la tabla `ft_tickets_ia`\n- `estatus_ticket <> 'CANCELADO'`"}
2025-06-16 17:43:18,721 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-16 17:45:58,513 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-17 09:36:00,272 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-17 10:24:12,060 - INFO - Payload: {'type': 'sql', 'question': '¿Podrías entregarme una estadística general de tickets del año 2025?', 'content': "select\n\textract(year from tks.fecha_registro) as anio,\n\tcount(*) filter(where tks.estatus_ticket <> 'CANCELADO') as tickets_registrados,\n\tcount(*) filter(where tks.estatus_ticket = 'ATENDIDO' or (not tks.fecha_cierre is null and not tks.estatus_ticket in ('CANCELADO'))) as tickets_atendidos,\n\tcount(*) filter(where not tks.estatus_ticket in ('ATENDIDO', 'CANCELADO') and tks.fecha_cierre is null) as tickets_abiertos,\n\tcount(*) filter(where tks.estatus_ticket = 'EN PROCESO' and tks.fecha_cierre is null) as tickets_proceso,\n\tcount(*) filter(where tks.estatus_ticket = 'EN PROCESO' and tks.fecha_cierre is null and estatus_atencion = 'FUERA DE TIEMPO') as tickets_fuera_tiempo\nfrom ft_tickets_ia tks\t\nwhere extract(year from tks.fecha_registro) = extract(year from CURRENT_DATE)\ngroup by extract(year from tks.fecha_registro);"}
2025-06-17 10:28:39,112 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-17 10:34:10,629 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-17 10:46:28,681 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-17 12:02:35,184 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-17 12:03:37,858 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-17 12:05:49,398 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-17 12:06:47,828 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-17 12:08:06,814 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-17 13:12:45,125 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-17 13:20:03,013 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-17 13:20:40,358 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-17 13:21:40,662 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-17 13:36:29,010 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-17 14:02:41,486 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-17 15:01:36,983 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-17 15:38:03,536 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-17 16:37:30,492 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-17 16:40:05,151 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-17 16:42:00,059 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-17 16:50:01,252 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-17 17:41:59,310 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-17 17:42:58,289 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-17 17:44:13,234 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-17 17:53:29,200 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-17 17:55:09,729 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-17 17:55:29,037 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-17 17:57:06,438 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-17 17:58:01,331 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-17 17:58:34,777 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-17 18:00:25,444 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-17 18:02:11,192 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-18 09:08:18,818 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-18 09:16:52,330 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-18 09:52:47,643 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-18 10:11:03,074 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-18 10:11:31,933 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-18 10:18:12,212 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-18 10:31:29,359 - INFO - Payload: {'type': 'docs', 'question': '¿Cómo identificar tickets registrados o atendidos en esta semana?', 'content': "Se considera que un ticket fue registrado esta semana si su fecha_registro pertenece a la semana calendario actual, es decir: `DATE_TRUNC('week', fecha_registro) = DATE_TRUNC('week', CURRENT_DATE)`\n"}
2025-06-18 10:35:50,004 - INFO - Payload: {'type': 'sql', 'question': '¿Cuantos tickets se han abierto en esta semana y de esos cuantos siguen en proceso y cuantos se han atendido?', 'content': "select\n\tdate_part('week', CURRENT_DATE) as semana,\n\tcount(*) filter(where estatus_ticket <> 'CANCELADO') as tickets_registrados,\n\tcount(*) filter(where estatus_ticket = 'EN PROCESO' and fecha_cierre is null) as tickets_proceso,\n\tcount(*) filter(where estatus_ticket = 'ATENDIDO' or (not fecha_cierre is null and not estatus_ticket in ('CANCELADO'))) as tickets_atendidos\nfrom ft_tickets_ia\nwhere DATE_TRUNC('week', fecha_registro) = DATE_TRUNC('week', CURRENT_DATE);"}
2025-06-18 10:38:09,894 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-18 10:47:50,067 - INFO - Payload: {'type': 'docs', 'question': '¿Qué pasos debe seguir el agente cuando el usuario solicita un ranking o una agrupación de información sobre los tickets?', 'content': 'Cuando el usuario solicite un **ranking o una agrupación** (por ejemplo: “ranking por área”, “tickets agrupados por mes”, “colaborador con más tickets”), se deben considerar las siguientes reglas generales para construir la consulta SQL:\n\n- 1️⃣ Identificar el criterio de agrupación principal\n\t- Determinar si se agrupa por dimensión organizacional (departamento, área, colaborador_asignado, etc.) o por atributo temporal (fecha_registro, mes, año).\n- 2️⃣ Filtrar correctamente el subconjunto de tickets a analizar\n- 3️⃣ Agregar los conteos o métricas correspondientes\n\t- Contar registros con COUNT(*)\n\t- Usar COUNT(*) FILTER (...) para métricas condicionales (por ejemplo, cuántos están fuera de tiempo).\n- 4️⃣ Aplicar ordenamiento (ranking)\n\t- Usar ORDER BY en la métrica principal, descendente o ascendente según lo solicitado.\n\t- Si es necesario limitar resultados por grupo, considerar ROW_NUMBER() con PARTITION BY.\n- 5️⃣ Evitar errores comunes\n\t- No usar subconsultas o CTEs innecesarios si un GROUP BY simple resuelve la necesidad.\n\t- No agregar columnas en el SELECT que no estén en el GROUP BY o dentro de una función de agregación.'}
2025-06-18 11:45:32,815 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-18 11:45:57,391 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-18 11:47:37,993 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-18 11:48:41,799 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-18 11:49:18,512 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-18 11:55:24,052 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-18 11:56:10,046 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-18 12:06:23,295 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-18 12:06:48,611 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-18 12:07:51,674 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-18 12:08:59,610 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-18 12:26:33,211 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-18 12:27:06,970 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-18 12:30:53,623 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-18 12:35:39,341 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-18 12:39:28,834 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-18 12:45:35,872 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-18 12:54:43,626 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-18 13:43:38,010 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-18 13:44:12,487 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-18 14:53:15,074 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-18 14:58:50,602 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-18 14:59:35,992 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-18 15:05:16,170 - INFO - Payload: {'type': 'sql', 'question': 'Quiero saber cuántos tickets se han creado para cada combinación de sistema y estatus.', 'content': "select\n   sistema,\n   estatus_ticket,\n   count(*) AS cantidad\nfrom ft_tickets_ia\nwhere anio_registro = extract('YEAR' from CURRENT_DATE)\ngroup by sistema, estatus_ticket\norder by sistema"}
2025-06-18 15:06:22,062 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-18 15:29:40,598 - ERROR - ✅ Entrenamiento exitoso. El agente ha aprendido esta respuesta.
NoneType: None
2025-06-18 15:43:04,479 - INFO - Payload: {'type': 'sql', 'question': 'Calcula cuántos tickets se generaron en promedio por mes durante 2024, tomando como base el número de tickets registrados en cada mes', 'content': 'with tickets_mensuales as (\n  select\n    mes_registro as mes,\n    count(folio_ticket) as tickets_por_mes\n  from ft_tickets_ia\n  where extract(year from fecha_registro) = 2024\n  group by mes_registro\n)\nselect avg(tickets_por_mes)::int as promedio_mensual_2024\nfrom tickets_mensuales;'}
2025-06-18 15:47:51,768 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-18 15:58:05,282 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-18 16:10:32,272 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-18 16:15:33,749 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-18 16:15:52,617 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-18 16:23:23,824 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-18 16:23:35,436 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-18 16:26:56,199 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-18 16:34:24,283 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-18 16:35:22,907 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-18 16:37:47,727 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-19 09:05:27,523 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-19 09:06:47,828 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-19 09:36:15,115 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-19 09:37:42,721 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-19 10:37:05,099 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-19 11:18:41,678 - ERROR - ❌ Error al ejecutar el SQL
{'error': {'message': 'Fallo al generar SQL: Error al ejecutar la consulta SQL en la base de datos', 'status_code': 500}}
NoneType: None
2025-06-19 11:20:21,725 - ERROR - ❌ Error al ejecutar el SQL
{'error': {'message': 'Fallo al generar SQL: Error al ejecutar la consulta SQL en la base de datos', 'status_code': 500}}
NoneType: None
2025-06-19 11:21:53,075 - ERROR - ❌ Error al ejecutar el SQL
{'error': {'message': 'Fallo al generar SQL: Error al ejecutar la consulta SQL en la base de datos', 'status_code': 500}}
NoneType: None
2025-06-19 11:22:23,322 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-19 11:23:44,620 - ERROR - ❌ Error al ejecutar el SQL
{'error': {'message': 'Fallo al generar SQL: Error al ejecutar la consulta SQL en la base de datos', 'status_code': 500}}
NoneType: None
2025-06-19 11:27:00,412 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-19 11:28:28,442 - ERROR - Error al consultar el backend: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
Traceback (most recent call last):
  File "C:\Users\drodriguez\Documents\03_IA\agentes_sql_ia\frontend\views\agente_sql.py", line 60, in <module>
    sql_response.raise_for_status()
  File "C:\Users\drodriguez\nim-env\Lib\site-packages\requests\models.py", line 1024, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: Internal Server Error for url: http://localhost:8000/generate_sql
2025-06-24 10:24:18,014 - INFO - Payload: {'type': 'sql', 'question': 'Clasificar tickets sin cerrar según su antigüedad en intervalos de quince días y contar cuántos hay en cada intervalo', 'content': "with tickets_abiertos_rangos as (\nselect\n  case\n    when (current_date - fecha_registro) <= 15 then '0–15 días'\n    when (current_date - fecha_registro) <= 30 then '16–30 días'\n    when (current_date - fecha_registro) <= 45 then '31–45 días'\n    else 'Más de 45 días'\n  end as rango_abierto,\n  folio_ticket\nfrom ft_tickets_ia\nwhere fecha_cierre is null\nand estatus_ticket not in ('ATENDIDO', 'CANCELADO')\n)\nselect\n\trango_abierto,\n\tcount(*)\nfrom tickets_abiertos_rangos\ngroup by rango_abierto;"}
2025-06-24 10:37:04,677 - INFO - Payload: {'type': 'sql', 'question': 'Necesito que se muestren los tickets abiertos agrupados por intervalos de 15 días (15, 30, 45 y más de 45 días).', 'content': "with tickets_abiertos_rangos as (\nselect\n  case\n    when (current_date - fecha_registro) <= 15 then '0–15 días'\n    when (current_date - fecha_registro) <= 30 then '16–30 días'\n    when (current_date - fecha_registro) <= 45 then '31–45 días'\n    else 'Más de 45 días'\n  end as rango_abierto,\n  folio_ticket\nfrom ft_tickets_ia\nwhere fecha_cierre is null\nand estatus_ticket not in ('ATENDIDO', 'CANCELADO')\n)\nselect\n\trango_abierto,\n\tcount(*)\nfrom tickets_abiertos_rangos\ngroup by rango_abierto;"}
